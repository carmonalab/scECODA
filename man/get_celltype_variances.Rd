% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.r
\name{get_celltype_variances}
\alias{get_celltype_variances}
\title{Calculates the variance of cell types across samples.}
\usage{
get_celltype_variances(
  ecoda_object,
  show_plot = TRUE,
  label_points = TRUE,
  plot_title = "",
  smooth_method = "lm",
  descending = TRUE
)
}
\arguments{
\item{ecoda_object}{An initialized \code{\link{ECODA}} object containing
CLR-transformed data in the \code{clr} slot.}

\item{show_plot}{Logical (default: \code{TRUE}). If \code{TRUE}, a mean-variance
plot is generated using the internal \code{varmeanplot} function.}

\item{label_points}{Logical (default: \code{TRUE}). If \code{TRUE}, the points
on the plot will be labeled with cell type names.}

\item{plot_title}{Character string (default: ""). Title for the generated plot.}

\item{smooth_method}{Character string (default: "lm"). Smoothing method to use
for the regression line in the mean-variance plot (e.g., "lm", "loess").}

\item{descending}{Logical (default: \code{TRUE}). If \code{TRUE}, the returned
data frame is sorted by variance in descending order.}
}
\value{
A data frame (samples as rows, cell types as columns) containing:
\itemize{
\item \code{celltype}: The name of the cell type.
\item \code{avg_clr_abundance}: The mean CLR value for that cell type across all samples.
\item \code{Variance}: The variance of the CLR values for that cell type across all samples.
\item \code{cumulative_variance}: Cumulative sum of the variance, ranked by variance.
\item \code{variance_exp}: The proportion of total variance explained cumulatively.
}
}
\description{
This function takes the Centered Log-Ratio (CLR) transformed cell type
abundance data from an \code{\link{ECODA}} object, calculates the mean CLR
abundance and variance for each cell type, and optionally generates a
mean-variance plot. It also calculates the cumulative variance explained
by the cell types when ranked by variance.
}
\examples{
\dontrun{
# Assuming 'ecoda_obj' is a created ECODA object

# Calculate variances and show the plot
df_var <- get_celltype_variances(ecoda_obj)

# Calculate variances without plotting, sorted by ascending variance
df_var_asc <- get_celltype_variances(ecoda_obj, show_plot = FALSE, descending = FALSE)
}
}
\seealso{
\code{\link{ECODA}}, \code{\link{varmeanplot}}
}
