% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.r
\name{impute_zeros}
\alias{impute_zeros}
\title{Impute zero values in count or frequency data}
\usage{
impute_zeros(df, is_freq = FALSE, counts_min = 1, xmin_factor = 2/3)
}
\arguments{
\item{df}{A data frame or matrix where zeros need to be imputed. Rows are
typically samples and columns are cell types.}

\item{is_freq}{Logical (default: \code{FALSE}). If \code{TRUE}, the function
treats the input as relative frequencies and uses the minimum observed
non-zero value for imputation. If \code{FALSE}, it treats the input as raw
counts.}

\item{counts_min}{Numeric (default: 1). The base value used for count
imputation. Only used if \code{is_freq = FALSE}.}

\item{xmin_factor}{Numeric (default: 2/3). The multiplier applied to the
minimum value (\code{counts_min} for counts or the observed minimum for
frequencies) to determine the imputation value.}
}
\value{
A data frame or matrix of the same dimensions as \code{df} with all
zero values replaced by the calculated imputation value.
}
\description{
This function replaces zero values in a data frame or matrix to facilitate
downstream transformations that require strictly positive values, such as the
Centered Log-Ratio (CLR) transformation. It employs a simple multiplicative
replacement strategy for both raw counts and relative frequencies.
}
\details{
The imputation logic differs based on the type of data:
\itemize{
\item \strong{Counts:} Zeros are replaced by a fraction of a minimum count
(typically 1). Formula: \code{0 + counts_min * xmin_factor}.
\item \strong{Frequencies:} Zeros are replaced by a fraction of the
smallest observed non-zero value in the dataset.
Formula: \code{0 + min(non_zero_values) * xmin_factor}.
}
}
\examples{
# Impute zeros in a count matrix
counts_df <- data.frame(A = c(10, 0, 5), B = c(20, 10, 0))
impute_zeros(counts_df, is_freq = FALSE)

# Impute zeros in a frequency matrix
freq_df <- data.frame(A = c(0.5, 0, 0.2), B = c(0.5, 1.0, 0.8))
impute_zeros(freq_df, is_freq = TRUE)
}
