% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.r
\name{plot_heatmap}
\alias{plot_heatmap}
\title{Generates a Heatmap of CLR-transformed Cell Type Abundances.}
\usage{
plot_heatmap(
  ecoda_object,
  label_col,
  cluster_rows = TRUE,
  cluster_cols = TRUE,
  scale = "none",
  clustering_method = "ward.D2",
  angle_col = "90",
  ...
)
}
\arguments{
\item{ecoda_object}{An \link[=ECODA-class]{ECODA} object containing the CLR-transformed
abundances in the \code{clr} slot.}

\item{label_col}{Character string. The name of the column in \code{ecoda_object@metadata}
to use for annotating the samples (columns) of the heatmap.}

\item{cluster_rows}{Logical (default: \code{TRUE}). Whether to apply hierarchical
clustering to the cell types (rows).}

\item{cluster_cols}{Logical (default: \code{TRUE}). Whether to apply hierarchical
clustering to the samples (columns).}

\item{scale}{Character string (default: \code{"none"}). Method for scaling the
CLR abundance values within the heatmap. Options include "none",
"row", or "column". Note: The data is mean-centered before passing
to \code{pheatmap}, but further scaling is controlled here.}

\item{clustering_method}{Character string (default: \code{"ward.D2"}). The clustering
method to use for hierarchical clustering. Options are
passed directly to \code{hclust} (e.g., "complete", "average", "ward.D2").}

\item{angle_col}{Character string (default: \code{"90"}). Angle of the sample
labels (columns).}

\item{...}{Additional arguments passed directly to the \code{pheatmap} function.}
}
\value{
A \code{pheatmap} object, which is typically visualized automatically
when called interactively.
}
\description{
This function visualizes the CLR-transformed abundance matrix after mean-centering,
allowing for clustering of both cell types and samples, and includes
a sample annotation sidebar based on a specified metadata column.
It is important to not re-scale in order to avoid amplifying tiny differences.
}
\examples{
\dontrun{
# Assuming 'ecoda_obj' is a created ECODA object with metadata

# Generate a heatmap clustered by both cell types and samples,
# annotated by the 'Condition' column in the metadata:
p1 <- plot_heatmap(
  ecoda_obj,
  label_col = "Condition",
  main = "CLR Abundance Heatmap",
  fontsize = 8
)

# Generate a heatmap without clustering the samples:
p2 <- plot_heatmap(
  ecoda_obj,
  label_col = "Batch",
  cluster_cols = FALSE
)
}
}
\seealso{
\link[=ECODA-class]{ECODA}, \code{\link{pheatmap}}
}
