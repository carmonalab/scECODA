---
title: "Create ECODA object from SingleCellExperiment object"
author: "Christian Halter"
date: "`r Sys.Date()`"
output:
  BiocStyle::html_document:
    toc_float: true
  BiocStyle::pdf_document: default
---


# Load example dataset

```{r load-library, message=FALSE, warning=FALSE}
library(scRNAseq)
library(scECODA)
```

```{r}
all.ds <- surveyDatasets()
ds <- 1
sce <- fetchDataset(all.ds@listData[["name"]][ds], all.ds@listData[["version"]][ds])

names(sce@colData)
```


# Create ECODA object

```{r}

ecoda_object <- create_ecoda_object(
  sce,
  sample_col = "sample",
  celltype_col = "cluster",
  get_pb = TRUE
)

plot_pca(
  ecoda_object,
  label_col = "Condition",
  title = "PCA - cell type composition"
)
plot_pca(
  ecoda_object,
  slot = "pb",
  label_col = "Condition",
  title = "PCA - pseudobulk"
)
```


# Session Info

```{r}
sessionInfo()
```
